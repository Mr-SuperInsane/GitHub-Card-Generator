<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHubリポジトリカード生成ツール</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; line-height: 1.6; color: #333; max-width: 800px; margin: 20px auto; padding: 0 15px; background-color: #f9f9f9; }
        h1 { text-align: center; color: #24292e; }
        .container { background-color: #fff; padding: 25px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        input[type="url"] { width: 100%; padding: 10px; font-size: 16px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { display: block; width: 100%; padding: 12px; font-size: 16px; color: #fff; background-color: #28a745; border: none; border-radius: 4px; cursor: pointer; margin-top: 15px; }
        button:hover { background-color: #218838; }
        textarea { width: 100%; height: 200px; margin-top: 15px; font-family: monospace; font-size: 14px; border: 1px solid #ccc; border-radius: 4px; }
        h2 { margin-top: 30px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
        #preview { border: 1px dashed #ccc; padding: 20px; border-radius: 5px; min-height: 100px; margin-top: 15px; }
    </style>
</head>
<body>

    <div class="container">
        <h1>GitHubリポジトリカード生成ツール</h1>
        <p>WordPressブログ用のGitHubリポジトリカードを生成します。リポジトリのURLを入力してください。</p>
        <input type="url" id="github-url" placeholder="https://github.com/username/repository">
        <button onclick="generateCard()">カードを生成</button>

        <h2>プレビュー</h2>
        <div id="preview">ここにプレビューが表示されます</div>

        <h2>WordPress用HTMLコード</h2>
        <textarea id="html-code" readonly placeholder="ここにHTMLコードが出力されます"></textarea>
    </div>

    <script>
        async function generateCard() {
            const url = document.getElementById('github-url').value;
            const preview = document.getElementById('preview');
            const codeOutput = document.getElementById('html-code');

            preview.innerHTML = '読み込み中...';
            codeOutput.value = '';

            if (!url.includes('github.com')) {
                preview.innerHTML = '<p style="color: red;">有効なGitHubのURLを入力してください。</p>';
                return;
            }

            const pathParts = new URL(url).pathname.split('/').filter(part => part);
            if (pathParts.length < 2) {
                preview.innerHTML = '<p style="color: red;">リポジトリのパスが見つかりません。(例: username/repository)</p>';
                return;
            }

            const repoPath = `${pathParts[0]}/${pathParts[1]}`;
            const apiUrl = `https://api.github.com/repos/${repoPath}`;

            try {
                const response = await fetch(apiUrl);
                if (!response.ok) {
                    throw new Error(`GitHub APIからの応答エラー: ${response.status}`);
                }
                const data = await response.json();

                const cardHtml = `
<style>
.gh-card-container {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    padding: 16px;
    margin: 1.5em 0;
    line-height: 1.4;
    background-color: #fff;
    max-width: 600px;
}
.gh-card-container a {
    text-decoration: none;
    color: inherit;
}
.gh-card-header {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
}
.gh-card-header svg {
    display: inline-block;
    vertical-align: text-bottom;
    margin-right: 8px;
}
.gh-card-repo-name {
    font-weight: 600;
    font-size: 1.1em;
    color: #0366d6;
}
.gh-card-repo-name:hover {
    text-decoration: underline;
}
.gh-card-description {
    color: #586069;
    font-size: 0.9em;
    margin-bottom: 16px;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    min-height: 2.5em;
}
.gh-card-footer {
    display: flex;
    align-items: center;
    font-size: 0.8em;
    color: #586069;
}
.gh-card-footer-item {
    display: flex;
    align-items: center;
    margin-right: 16px;
}
.gh-card-footer-item svg {
    margin-right: 4px;
}
.gh-card-language-color {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    margin-right: 4px;
    border: 1px solid #d1d5da;
}
.gh-card-owner {
    display: flex;
    align-items: center;
    margin-left: auto;
}
.gh-card-owner img {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    margin-right: 6px;
}
</style>
<div class="gh-card-container">
    <a href="${data.html_url}" target="_blank" rel="noopener noreferrer">
        <div class="gh-card-header">
            <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
                <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 0 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Z M4.5 1h8V.75H4.5a1.75 1.75 0 0 0 0 3.5h8V3h-8a1.75 1.75 0 0 0 0-3.5Zm-2.25 8a.75.75 0 0 0 .75.75h4.5a.75.75 0 0 0 0-1.5h-4.5a.75.75 0 0 0-.75.75Z"></path>
            </svg>
            <span class="gh-card-repo-name">${data.full_name}</span>
        </div>
        <div class="gh-card-description">${data.description || 'No description provided.'}</div>
        <div class="gh-card-footer">
            ${data.language ? `<div class="gh-card-footer-item"><span class="gh-card-language-color" style="background-color: ${getLanguageColor(data.language)};"></span><span>${data.language}</span></div>` : ''}
            <div class="gh-card-footer-item">
                <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16"><path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.75.75 0 0 1-1.088.791L8 13.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.192L.644 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Z"></path></svg>
                <span>${data.stargazers_count}</span>
            </div>
            <div class="gh-card-footer-item">
                <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16"><path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a.75.75 0 0 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0Z M4.25 5.5a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm7.5 0a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"></path></svg>
                <span>${data.forks_count}</span>
            </div>
            <div class="gh-card-owner">
                <img src="${data.owner.avatar_url}" alt="${data.owner.login}">
                <span>${data.owner.login}</span>
            </div>
        </div>
    </a>
</div>
`;
                
                preview.innerHTML = cardHtml;
                codeOutput.value = cardHtml.trim();

            } catch (error) {
                preview.innerHTML = `<p style="color: red;">エラーが発生しました: ${error.message}</p>`;
            }
        }
        
        // This is a simplified map. Not all languages are covered.
        function getLanguageColor(language) {
            const colors = {
                "JavaScript": "#f1e05a", "TypeScript": "#3178c6", "Python": "#3572A5",
                "HTML": "#e34c26", "CSS": "#563d7c", "Java": "#b07219", "Ruby": "#701516",
                "PHP": "#4F5D95", "C++": "#f34b7d", "C#": "#178600", "Go": "#00ADD8",
                "Swift": "#ffac45", "Kotlin": "#F18E33", "Rust": "#dea584", "Shell": "#89e051"
            };
            return colors[language] || '#ededed';
        }
    </script>
</body>
</html>